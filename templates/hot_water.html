{% extends "base.html" %}
{% block content %}


<div class="box">
	<h1>Трубопроводы с температурным расширением (отопление, ГВ)</h1>
	{% with messages = get_flashed_messages() %}
		{% if messages %}
   			{% for message in messages %}
         		<p>{{ message }}</p>
        	{% endfor %}
      	{% endif %}
    {% endwith %}
	<form action="" method="post" class="form">
	{{ form.hidden_tag() }}
		<table class="table-wrapper">
			<thead>
				<tr>
<!--					{% for field in form if field.name in ['base_material', 'direction_type', 'system', 'pipe_type', 'support_type'] %}-->
<!--					<th class="col-2 col-12-xsmall">{{ field.label }}</th>-->
<!--					{% endfor %}-->
<!--					{% for field in form if field.name not in ['base_material', 'direction_type', 'system', 'pipe_type', 'support_type', 'submit', 'csrf_token'] %}-->
<!--					<th class="col-1 col-12-xsmall">{{ field.label }}</th>-->
<!--					{% endfor %}-->
					{% for field in form if field.name not in ['submit', 'csrf_token']%}
						<th class="col-2 col-12-xsmall">{{ field.label }}</th>
						{% endfor %}
				</tr>

			</thead>
				<tbody>
					<tr>
						{% for field in form %}
						<td>{{ field() }}</td>
						{% endfor %}
					</tr> <!--ряд с ячейками тела таблицы-->
				</tbody>
		</table>
	</form>

	<script>
        let dir_select = document.getElementById("direction_type");
        let mounting_select = document.getElementById("mounting");

        dir_select.onchange = function()  {
            direction_type = dir_select.value;
            fetch('/support_system/hot_water/mounting/' + direction_type).then(function(response) {
                response.json().then(function(data) {
                    let optionHTML = '';

                    for (let fastening of data.fastenings) {
                        optionHTML += '<option value="' + fastening.id + '">' + fastening.name + '</option>';
                    }
                    mounting_select.innerHTML = optionHTML;
                });
            });
        }
    </script>

</div>

{% endblock %}